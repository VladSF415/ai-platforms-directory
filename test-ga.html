<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GA Test Page</title>

  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-87QJXFEQQD"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-87QJXFEQQD', {
      'debug_mode': true,
      'send_page_view': true
    });

    console.log('%c✓ GA Script Loaded', 'color: green; font-weight: bold');
  </script>
</head>
<body style="font-family: monospace; padding: 40px; max-width: 800px; margin: 0 auto;">
  <h1>Google Analytics Debug Test</h1>

  <div id="results" style="background: #f0f0f0; padding: 20px; border: 2px solid #000; margin: 20px 0;">
    <p>Testing GA setup...</p>
  </div>

  <h2>Checklist:</h2>
  <ul id="checklist" style="font-size: 16px; line-height: 2;">
    <li id="check1">⏳ Checking if gtag function exists...</li>
    <li id="check2">⏳ Checking dataLayer...</li>
    <li id="check3">⏳ Checking GA script loaded...</li>
    <li id="check4">⏳ Checking Network requests...</li>
  </ul>

  <h2>Instructions:</h2>
  <ol style="line-height: 2;">
    <li>Open DevTools (F12) → Console tab</li>
    <li>Look for green "✓ GA Script Loaded" message</li>
    <li>Switch to Network tab</li>
    <li>Filter by "google"</li>
    <li>Look for requests to:
      <ul>
        <li><code>www.googletagmanager.com/gtag/js</code></li>
        <li><code>www.google-analytics.com/g/collect</code></li>
      </ul>
    </li>
  </ol>

  <h2>What to check in Console:</h2>
  <div style="background: #000; color: #0f0; padding: 15px; font-family: monospace;">
    <pre>// Run these commands in Console:
typeof gtag
// Should return: "function"

window.dataLayer
// Should return: Array with items

navigator.sendBeacon
// Should return: function or true</pre>
  </div>

  <script>
    // Run checks
    setTimeout(() => {
      const results = document.getElementById('results');
      const checks = [];

      // Check 1: gtag exists
      if (typeof gtag === 'function') {
        document.getElementById('check1').innerHTML = '✅ gtag function exists';
        checks.push('✅ gtag() function is defined');
      } else {
        document.getElementById('check1').innerHTML = '❌ gtag function NOT found';
        checks.push('❌ gtag() NOT defined - GA script failed to load');
      }

      // Check 2: dataLayer exists
      if (window.dataLayer && Array.isArray(window.dataLayer)) {
        document.getElementById('check2').innerHTML = `✅ dataLayer exists (${window.dataLayer.length} items)`;
        checks.push(`✅ dataLayer has ${window.dataLayer.length} items`);
      } else {
        document.getElementById('check2').innerHTML = '❌ dataLayer NOT found';
        checks.push('❌ dataLayer NOT found');
      }

      // Check 3: GA script tag
      const gaScript = document.querySelector('script[src*="googletagmanager"]');
      if (gaScript) {
        document.getElementById('check3').innerHTML = '✅ GA script tag exists in DOM';
        checks.push('✅ GA script tag found in DOM');
      } else {
        document.getElementById('check3').innerHTML = '❌ GA script tag NOT found';
        checks.push('❌ GA script tag NOT in DOM');
      }

      // Check 4: Network - manual check
      document.getElementById('check4').innerHTML = '⚠️ Check Network tab manually (see instructions above)';

      // Display results
      results.innerHTML = '<h3>Test Results:</h3>' +
        checks.map(check => `<p style="margin: 5px 0;">${check}</p>`).join('') +
        '<hr><p><strong>GA Measurement ID:</strong> G-87QJXFEQQD</p>' +
        '<p><strong>Debug Mode:</strong> Enabled</p>';

      // Send test event
      if (typeof gtag === 'function') {
        gtag('event', 'test_event', {
          'event_category': 'engagement',
          'event_label': 'GA Test Page',
          'value': 1
        });
        results.innerHTML += '<p style="color: green; font-weight: bold;">✅ Test event sent to GA</p>';
        console.log('%c✓ Test event sent to GA', 'color: green; font-weight: bold');
      }

      // Log to console
      console.log('%c=== GA DEBUG RESULTS ===', 'color: blue; font-size: 16px; font-weight: bold');
      console.log('gtag type:', typeof gtag);
      console.log('dataLayer:', window.dataLayer);
      console.log('dataLayer length:', window.dataLayer?.length);
      console.log('GA Script:', gaScript);
      console.log('%c======================', 'color: blue; font-size: 16px; font-weight: bold');
    }, 2000);
  </script>
</body>
</html>
